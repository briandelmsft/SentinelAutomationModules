{
    "$schema": "https://schema.management.azure.com/schemas/2019-04-01/deploymentTemplate.json#",
    "contentVersion": "1.0.0.0",
    "parameters": {
        "STATCoordinatorPlaybookName": {
            "defaultValue": "STAT-Coordinator",
            "type": "String"
        },
        "CustomConnectorName": {
            "defaultValue": "SentinelTriageAssistant",
            "type": "String"
        },
        "CustomConnectorDisplayName": {
            "defaultValue": "Sentinel Triage AssistanT - STAT",
            "type": "String"
        },
        "BaseModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the Base Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<BaseModuleName>",
            "type": "String"
        },
        "OOFModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the OOF Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<OOFModuleName>",
            "type": "String"
        },
        "AADRisks_resourceid": {
            "metadata": {
                "description": "Resource Id of the AADRisks Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<AADRisksModuleName>",
            "type": "String"
        },
        "FileModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the File Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<FileModuleName>",
            "type": "String"
        },
        "KQLModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the KQL Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<KQLModuleName>",
            "type": "String"
        },
        "MCASModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the MCAS Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<MCASModuleName>",
            "type": "String"
        },
        "MDEModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the MDE Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<MDEModuleName>",
            "type": "String"
        },
        "RelatedAlertsModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the RelatedAlerts Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<RelatedAlertsModuleName>",
            "type": "String"
        },
        "RunPlaybook_resourceid": {
            "metadata": {
                "description": "Resource Id of the RunPlaybook Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<RunPlaybookModuleName>",
            "type": "String"
        },
        "ScoringModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the ScoringModule Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<ScoringModuleName>",
            "type": "String"
        },
        "ThreatIntelModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the TI Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<TIModuleName>",
            "type": "String"
        },
        "UEBAModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the UEBA Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<UEBAModuleName>",
            "type": "String"
        },
        "WatchlistModule_resourceid": {
            "metadata": {
                "description": "Resource Id of the Watchlist Module Playbook"
            },
            "defaultValue": "/subscriptions/<subscriptionId>/resourceGroups/<resourceGroupName>/providers/Microsoft.Logic/workflows/<WatchlistModuleName>",
            "type": "String"
        }
    },
    "variables": {},
    "resources": [
        {
            "type": "Microsoft.Web/customApis",
            "apiVersion": "2016-06-01",
            "name": "[parameters('CustomConnectorName')]",
            "location": "[resourceGroup().location]",
            "dependsOn": [
                "[resourceId('Microsoft.Logic/workflows', parameters('STATCoordinatorPlaybookName'))]"
            ],
            "properties": {
                "connectionParameters": {},
                "capabilities": [],
                "description": "The Microsoft Sentinel Triage assistance is an automation toolkit to simplify the construction of automation to analyze Sentinel Incidents (version 0.5.0)",
                "displayName": "[parameters('CustomConnectorDisplayName')]",
                "iconUri": "data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACsAAAAtCAYAAAA3BJLdAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAAJcEhZcwAADsMAAA7DAcdvqGQAAAMjSURBVFhH7Zk/TFNRFMa/tg8BkWr8E0uRyGAwOki0NVYTBhIlGISFGnVgrC5EGk1IGBwkMQw6NG7tggtxMDqoiYspEAZJoAZFISAJJFpsGLTUaqDQ1nfvuy20lL7b0vdqTX/JyT3f477ycbjv9N5WExVBgaBlY0FQNKsUCWvW7/djYmKCqdxiMplQWVnJVJYQszEGBweJcUVibGyM/ZbsKdxlMDQ0hMbGRpr79h+j404x/Jijo1hZmM1mmmfL/1HZby9eoaKigubZEgwGUdPeRvNcVHZbs4FAgI47Ra/X01EVs2+CWvjWaUoxCMDlPRGmJNLNiZm12WwwGo0058FisaC5uZkpCVmzt30CPqxoaE6oL4visWGTM5F0c2JmM6WrqwsOh4MpieLbrVKoYpYsKd5oaGhgd21F1ixZe8O1a/FIXq8Enjkr12z4U3smbYTfjbPZqcnLMtC1X0HpUxd23bvLrvCRF7PammrozpuhOXmcXeFDVbOkoiX2W9CeM1GtOVJFNQkeZM2Sht/v3wiik+GZQxCsbdQYqSqBVDjnZp/4dfHYzqzcHEJ0ehaRUQ8iX72SXg5IWgweZM3mklDvI6xctyH8/DXVkalZqknwoKrZnZIXs2sOJ+2rqzdusit8qLJFzOS1WlpaMDIyknIjI27mlIcY6OjogNvthtcrPVzJdHd3Y2BgAJOTk+zKVrgqG7r/UHySvzCVHtJLhavS6YDwtvoEHevq6rC4uEhPD6kgR/WZmRncWZrHp3Ao+y0ieWrDo+NcEfV+Z3dJXCgpp3Fw/itOrYbjOjlKP07Rn+s1OnbnVrgqu/7sJRYWfHD/3thgE4y7BWg3/bn1unUYLKfjTZ/Qe7iWZfI0NTXhwef3GJ6bTVlZ7gesnzb8xH+ExVDGMomLQgiXhFWmJDI5KTidTrhcLng8nuJJQVWKZpWiaFYpCsrstn22p6eHjjGmUY5Rf4gpiaNVBxD+tcwUcPbQXuz7ucSURF9fH8vkaW1tpT2WvC2n6rOqffKdaYhmmasNEipLvk+w2+1M5Rer1YrOzk6mJBLM/usUu4FSFJBZ4C9uB2sPxMPD5QAAAABJRU5ErkJggg==",
                "swagger": {
                    "swagger": "2.0",
                    "info": {
                        "version": "1.0.0",
                        "title": "STAT",
                        "description": "The Microsoft Sentinel Triage assistance is an automation toolkit to simplify the construction of automation to analyze Sentinel Incidents (version 0.5.0)"
                    },
                    "host": "[string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[0], '//')[1])]",
                    "basePath": "/",
                    "schemes": [
                        "https"
                    ],
                    "consumes": [],
                    "produces": [
                        "application/json"
                    ],
                    "paths": {
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/base')]": {
                            "post": {
                                "summary": "Base Module",
                                "description": "Sentinel Triage AssistanT Base Module enriches entities in the Sentinel Incidient to provide additional data for analysis",
                                "operationId": "BaseModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "EnrichIPsWithGeoData": {
                                                    "type": "boolean",
                                                    "description": "EnrichIPsWithGeoData",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "AddAccountComments": {
                                                    "type": "boolean",
                                                    "description": "Enrich Incident with Account details comment",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "AddIPComments": {
                                                    "type": "boolean",
                                                    "description": "Enrich Incident with IP details comment",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "Entities": {
                                                    "type": "string",
                                                    "description": "Entities",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "IncidentARMId": {
                                                    "type": "string",
                                                    "description": "IncidentARMId",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "WorkspaceId": {
                                                    "type": "string",
                                                    "description": "WorkspaceId",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                }
                                            },
                                            "default": {
                                                "EnrichIPsWithGeoData": true,
                                                "Entities": [],
                                                "IncidentARMId": "",
                                                "WorkspaceId": "abc"
                                            },
                                            "required": [
                                                "IncidentARMId",
                                                "WorkspaceId",
                                                "Entities"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "description": "Base Module Body",
                                            "properties": {
                                                "Accounts": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "RawEntity": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "accountName": {
                                                                        "type": "string",
                                                                        "description": "accountName in Accounts array RawEntity"
                                                                    },
                                                                    "upnSuffix": {
                                                                        "type": "string",
                                                                        "description": "upnSuffix in Accounts array RawEntity"
                                                                    },
                                                                    "isDomainJoined": {
                                                                        "type": "boolean",
                                                                        "description": "isDomainJoined in Accounts array RawEntity"
                                                                    },
                                                                    "displayName": {
                                                                        "type": "string",
                                                                        "description": "displayName in Accounts array RawEntity"
                                                                    },
                                                                    "friendlyName": {
                                                                        "type": "string",
                                                                        "description": "friendlyName in Accounts array RawEntity"
                                                                    },
                                                                    "ntDomain": {
                                                                        "type": "string",
                                                                        "description": "ntDomain in Accounts array RawEntity"
                                                                    },
                                                                    "sid": {
                                                                        "type": "string",
                                                                        "description": "sid in Accounts array RawEntity"
                                                                    },
                                                                    "aadTenantId": {
                                                                        "type": "string",
                                                                        "description": "aadTenantId in Accounts array RawEntity"
                                                                    },
                                                                    "aadUserId": {
                                                                        "type": "string",
                                                                        "description": "aadUserId in Accounts array RawEntity"
                                                                    },
                                                                    "dnsDomain": {
                                                                        "type": "string",
                                                                        "description": "dnsDomain in Accounts array RawEntity"
                                                                    },
                                                                    "additionalData": {
                                                                        "type": "object",
                                                                        "properties": {
                                                                            "TransitiveGroupsMembership": {
                                                                                "type": "array",
                                                                                "items": {
                                                                                    "type": "string"
                                                                                },
                                                                                "description": "TransitiveGroupsMembership in Accounts array RawEntity"
                                                                            },
                                                                            "OnPremisesDistinguishedName": {
                                                                                "type": "string",
                                                                                "description": "OnPremisesDistinguishedName in Accounts array RawEntity"
                                                                            },
                                                                            "SyncFromAad": {
                                                                                "type": "string",
                                                                                "description": "SyncFromAad in Accounts array RawEntity"
                                                                            },
                                                                            "MailAddress": {
                                                                                "type": "string",
                                                                                "description": "MailAddress in Accounts array RawEntity"
                                                                            },
                                                                            "IsDeleted": {
                                                                                "type": "string",
                                                                                "description": "IsDeleted in Accounts array RawEntity"
                                                                            },
                                                                            "IsEnabled": {
                                                                                "type": "string",
                                                                                "description": "IsEnabled in Accounts array RawEntity"
                                                                            },
                                                                            "ManagerName": {
                                                                                "type": "string",
                                                                                "description": "ManagerName in Accounts array RawEntity"
                                                                            },
                                                                            "GivenName": {
                                                                                "type": "string",
                                                                                "description": "GivenName in Accounts array RawEntity"
                                                                            },
                                                                            "UserType": {
                                                                                "type": "string",
                                                                                "description": "UserType in Accounts array RawEntity"
                                                                            },
                                                                            "Sources": {
                                                                                "type": "array",
                                                                                "items": {
                                                                                    "type": "string"
                                                                                },
                                                                                "description": "Sources in Accounts array RawEntity"
                                                                            },
                                                                            "UpnName": {
                                                                                "type": "string",
                                                                                "description": "UpnName in Accounts array RawEntity"
                                                                            }
                                                                        },
                                                                        "description": "additionalData object in Accounts array RawEntity"
                                                                    }
                                                                },
                                                                "description": "RawEntity object in Accounts array"
                                                            },
                                                            "userPrincipalName": {
                                                                "type": "string",
                                                                "description": "userPrincipalName in Accounts array"
                                                            },
                                                            "id": {
                                                                "type": "string",
                                                                "description": "Userid in Accounts array"
                                                            },
                                                            "onPremisesSecurityIdentifier": {
                                                                "type": "string",
                                                                "description": "onPremisesSecurityIdentifier in Accounts array"
                                                            },
                                                            "onPremisesDistinguishedName": {
                                                                "type": "string",
                                                                "description": "onPremisesDistinguishedName in Accounts array"
                                                            },
                                                            "onPremisesDomainName": {
                                                                "type": "string",
                                                                "description": "onPremisesDomainName in Accounts array"
                                                            },
                                                            "onPremisesSamAccountName": {
                                                                "type": "string",
                                                                "description": "onPremisesSamAccountName in Accounts array"
                                                            },
                                                            "onPremisesSyncEnabled": {
                                                                "type": "boolean",
                                                                "description": "onPremisesSyncEnabled in Accounts array"
                                                            },
                                                            "mail": {
                                                                "type": "string",
                                                                "description": "mail in Accounts array"
                                                            },
                                                            "city": {
                                                                "type": "string",
                                                                "description": "city in Accounts array"
                                                            },
                                                            "state": {
                                                                "type": "string",
                                                                "description": "state in Accounts array"
                                                            },
                                                            "country": {
                                                                "type": "string",
                                                                "description": "country in Accounts array"
                                                            },
                                                            "department": {
                                                                "type": "string",
                                                                "description": "department in Accounts array"
                                                            },
                                                            "jobTitle": {
                                                                "type": "string",
                                                                "description": "jobTitle in Accounts array"
                                                            },
                                                            "officeLocation": {
                                                                "type": "string",
                                                                "description": "officeLocation in Accounts array"
                                                            },
                                                            "accountEnabled": {
                                                                "type": "boolean",
                                                                "description": "accountEnabled in Accounts array"
                                                            },
                                                            "isAADPrivileged": {
                                                                "type": "boolean",
                                                                "description": "isAADPrivileged in Accounts array"
                                                            },
                                                            "isMfaRegistered": {
                                                                "type": "boolean",
                                                                "description": "isMfaRegistered in Accounts array"
                                                            },
                                                            "isSSPREnabled": {
                                                                "type": "boolean",
                                                                "description": "isSSPREnabled in Accounts array"
                                                            },
                                                            "isSSPRRegistered": {
                                                                "type": "boolean",
                                                                "description": "isSSPRRegistered in Accounts array"
                                                            },
                                                            "manager": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "userPrincipalName": {
                                                                        "type": "string",
                                                                        "description": "userPrincipalName of Manager in Accounts array"
                                                                    },
                                                                    "mail": {
                                                                        "type": "string",
                                                                        "description": "mail of Manager in Accounts array"
                                                                    },
                                                                    "id": {
                                                                        "type": "string",
                                                                        "description": "Userid of Manager in Accounts array"
                                                                    }
                                                                },
                                                                "description": "manager object in Accounts array"
                                                            },
                                                            "AssignedRoles": {
                                                                "type": "array",
                                                                "items": {},
                                                                "description": "AssignedRoles of user in Accounts array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of Account Entities"
                                                },
                                                "AccountsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Account Entities"
                                                },
                                                "Domains": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of Domain Entities"
                                                },
                                                "DomainsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Domain Entities"
                                                },
                                                "EntitiesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of all Entities"
                                                },
                                                "FileHashes": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of FileHashes"
                                                },
                                                "FileHashesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of FileHashes"
                                                },
                                                "Files": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of File Entities"
                                                },
                                                "FilesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of File Entities"
                                                },
                                                "Hosts": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of Host Entities"
                                                },
                                                "HostsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Host Entities"
                                                },
                                                "IPs": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "Address": {
                                                                "type": "string",
                                                                "description": "IP Address in IPs array"
                                                            },
                                                            "GeoData": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "asn": {
                                                                        "type": "string",
                                                                        "description": "asn in GeoData object in IPs array"
                                                                    },
                                                                    "carrier": {
                                                                        "type": "string",
                                                                        "description": "carrier in GeoData object in IPs array"
                                                                    },
                                                                    "city": {
                                                                        "type": "string",
                                                                        "description": "city in GeoData object in IPs array"
                                                                    },
                                                                    "cityCf": {
                                                                        "type": "integer",
                                                                        "format": "int32",
                                                                        "description": "cityCf in GeoData object in IPs array"
                                                                    },
                                                                    "continent": {
                                                                        "type": "string",
                                                                        "description": "continent in GeoData object in IPs array"
                                                                    },
                                                                    "country": {
                                                                        "type": "string",
                                                                        "description": "country in GeoData object in IPs array"
                                                                    },
                                                                    "countryCf": {
                                                                        "type": "integer",
                                                                        "format": "int32",
                                                                        "description": "countryCf in GeoData object in IPs array"
                                                                    },
                                                                    "ipAddr": {
                                                                        "type": "string",
                                                                        "description": "IP Address in GeoData object in IPs array"
                                                                    },
                                                                    "ipRoutingType": {
                                                                        "type": "string",
                                                                        "description": "ipRoutingType in GeoData object in IPs array"
                                                                    },
                                                                    "latitude": {
                                                                        "type": "string",
                                                                        "description": "latitude in GeoData object in IPs array"
                                                                    },
                                                                    "longitude": {
                                                                        "type": "string",
                                                                        "description": "longitude in GeoData object in IPs array"
                                                                    },
                                                                    "organization": {
                                                                        "type": "string",
                                                                        "description": "organization in GeoData object in IPs array"
                                                                    },
                                                                    "organizationType": {
                                                                        "type": "string",
                                                                        "description": "organizationType in GeoData object in IPs array"
                                                                    },
                                                                    "region": {
                                                                        "type": "string",
                                                                        "description": "region in GeoData object in IPs array"
                                                                    },
                                                                    "state": {
                                                                        "type": "string",
                                                                        "description": "state in GeoData object in IPs array"
                                                                    },
                                                                    "stateCf": {
                                                                        "type": "integer",
                                                                        "format": "int32",
                                                                        "description": "stateCf in GeoData object in IPs array"
                                                                    },
                                                                    "stateCode": {
                                                                        "type": "string",
                                                                        "description": "stateCode in GeoData object in IPs array"
                                                                    }
                                                                },
                                                                "description": "GeoData object in IPs array"
                                                            },
                                                            "RawEntity": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "address": {
                                                                        "type": "string",
                                                                        "description": "address in RawEntity object in IPs array"
                                                                    },
                                                                    "friendlyName": {
                                                                        "type": "string",
                                                                        "description": "friendlyName in RawEntity object in IPs array"
                                                                    }
                                                                },
                                                                "description": "IPAddress RawEntity object"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of IP Entities"
                                                },
                                                "IPsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of IP Entities"
                                                },
                                                "IncidentARMId": {
                                                    "type": "string",
                                                    "description": "Microsoft Sentinel IncidentARMId"
                                                },
                                                "OtherEntities": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of other unenriched Entities"
                                                },
                                                "URLs": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of URL Entities"
                                                },
                                                "URLsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of URL Entities"
                                                },
                                                "WorkspaceId": {
                                                    "type": "string",
                                                    "description": "Microsoft Sentinel WorkspaceId"
                                                }
                                            }
                                        }
                                    }
                                },
                                "x-ms-visibility": "important"
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/oofmodule')]": {
                            "post": {
                                "summary": "Out of Office Module",
                                "description": "Sentinel Triage AssistanT Module for determining if user entities are out of the office.",
                                "operationId": "OOFModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AllUsersInOffice": {
                                                    "type": "boolean",
                                                    "description": "true if All users are in the office"
                                                },
                                                "AllUsersOutOfOffice": {
                                                    "type": "boolean",
                                                    "description": "true if All users are out of the office"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "ExternalMessage": {
                                                                "type": "string",
                                                                "description": "External Out of Office message in DetailedResults array"
                                                            },
                                                            "InternalMessage": {
                                                                "type": "string",
                                                                "description": "Internal Out of Office message in DetailedResults array"
                                                            },
                                                            "OOFStatus": {
                                                                "type": "string",
                                                                "description": "Out of Office status in DetailedResults array"
                                                            },
                                                            "UPN": {
                                                                "type": "string",
                                                                "description": "UserPrincipalName in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of by user DetailedResults"
                                                },
                                                "UsersInOffice": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Users In the Office"
                                                },
                                                "UsersOutOfOffice": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Users Out of the Office"
                                                },
                                                "UsersUnknown": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Users with unknown Out of Office status"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/threatintel')]": {
                            "post": {
                                "summary": "Threat Intel Module",
                                "description": "Sentinel Triage AssistanT Module for determining if incident entities are in Threat Intelligence.",
                                "operationId": "ThreatIntel",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "CheckDomains": {
                                                    "type": "boolean",
                                                    "description": "Check Domain entities against Threat Intel",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "CheckFileHashes": {
                                                    "type": "boolean",
                                                    "description": "Check FileHash entities against Threat Intel",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "CheckIPs": {
                                                    "type": "boolean",
                                                    "description": "Check IP entities against Threat Intel",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "CheckURLs": {
                                                    "type": "boolean",
                                                    "description": "Check URL entities against Threat Intel",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Number of days to lookback in Threat Intel for matches",
                                                    "title": "",
                                                    "x-ms-visibility": "advanced"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AnyTIFound": {
                                                    "type": "boolean",
                                                    "description": "true if any Threat Intelligence is found"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "TIType": {
                                                                "type": "string",
                                                                "description": "Threat Intel type in DetailedResults array"
                                                            },
                                                            "TIData": {
                                                                "type": "string",
                                                                "description": "Threat Intel Data in DetailedResults array"
                                                            },
                                                            "SourceSystem": {
                                                                "type": "string",
                                                                "description": "Threat Intel SourceSystem in DetailedResults array"
                                                            },
                                                            "Description": {
                                                                "type": "string",
                                                                "description": "Threat Intel Description in DetailedResults array"
                                                            },
                                                            "ThreatType": {
                                                                "type": "string",
                                                                "description": "ThreatType in DetailedResults array"
                                                            },
                                                            "ConfidenceScore": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "ConfidenceScore in DetailedResults array"
                                                            },
                                                            "IndicatorId": {
                                                                "type": "string",
                                                                "description": "IndicatorId in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                },
                                                "DomainEntitiesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Domain Entities"
                                                },
                                                "DomainEntitiesWithTI": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Domain Entities with matching TI"
                                                },
                                                "DomainTIFound": {
                                                    "type": "boolean",
                                                    "description": "true if TI found for any Domain Entities"
                                                },
                                                "FileHashEntitiesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of FileHash Entities"
                                                },
                                                "FileHashEntitiesWithTI": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of FileHash Entities with matching TI"
                                                },
                                                "FileHashTIFound": {
                                                    "type": "boolean",
                                                    "description": "true if TI found for any FileHash Entities"
                                                },
                                                "IPEntitiesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of IP Entities"
                                                },
                                                "IPEntitiesWithTI": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of IP Entities with matching TI"
                                                },
                                                "IPTIFound": {
                                                    "type": "boolean",
                                                    "description": "true if TI found for any IP Entities"
                                                },
                                                "URLEntitiesCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of URL Entities"
                                                },
                                                "URLEntitiesWithTI": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of URL entities with matching TI"
                                                },
                                                "URLTIFound": {
                                                    "type": "boolean",
                                                    "description": "true if TI found for any URL Entities"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/relatedalerts')]": {
                            "post": {
                                "summary": "Related Alerts Module",
                                "description": "Sentinel Triage AssistanT Module for determining if entities have recent related alerts in Sentinel.",
                                "operationId": "RelatedAlerts",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "CheckAccounts": {
                                                    "type": "boolean",
                                                    "description": "Check Account entities against recent alerts",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "CheckHosts": {
                                                    "type": "boolean",
                                                    "description": "Check Host entities against recent alerts",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "CheckIPs": {
                                                    "type": "boolean",
                                                    "description": "Check IP entities against recent alerts",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Number of days to lookback in recent alerts for matches",
                                                    "title": ""
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "LookbackInDays"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "StartTime": {
                                                                "type": "string",
                                                                "description": "StartTime in DetailedResults array"
                                                            },
                                                            "DisplayName": {
                                                                "type": "string",
                                                                "description": "DisplayName in DetailedResults array"
                                                            },
                                                            "AlertName": {
                                                                "type": "string",
                                                                "description": "AlertName in DetailedResults array"
                                                            },
                                                            "AlertSeverity": {
                                                                "type": "string",
                                                                "description": "AlertSeverity in DetailedResults array"
                                                            },
                                                            "SystemAlertId": {
                                                                "type": "string",
                                                                "description": "SystemAlertId in DetailedResults array"
                                                            },
                                                            "ProviderName": {
                                                                "type": "string",
                                                                "description": "ProviderName in DetailedResults array"
                                                            },
                                                            "Tactics": {
                                                                "type": "string",
                                                                "description": "Tactics in DetailedResults array"
                                                            },
                                                            "AccountEntityMatch": {
                                                                "type": "boolean",
                                                                "description": "AccountEntityMatch in DetailedResults array"
                                                            },
                                                            "IPEntityMatch": {
                                                                "type": "boolean",
                                                                "description": "IPEntityMatch in DetailedResults array"
                                                            },
                                                            "HostEntityMatch": {
                                                                "type": "boolean",
                                                                "description": "HostEntityMatch in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                },
                                                "HighestSeverityAlert": {
                                                    "type": "string",
                                                    "description": "The severity of the highest severity alert found"
                                                },
                                                "RelatedAccountAlertsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Related Alerts found for Account Entities"
                                                },
                                                "RelatedAccountAlertsFound": {
                                                    "type": "boolean",
                                                    "description": "true if any Related Alerts found for Account Entities"
                                                },
                                                "RelatedAlertsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of all Related Alerts found"
                                                },
                                                "RelatedAlertsFound": {
                                                    "type": "boolean",
                                                    "description": "true if any Related Alerts found"
                                                },
                                                "RelatedHostAlertsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Related Alerts found for Host Entities"
                                                },
                                                "RelatedHostAlertsFound": {
                                                    "type": "boolean",
                                                    "description": "true if any Related Alerts found for Host Entities"
                                                },
                                                "RelatedIPAlertsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Related Alerts found for IP Entities"
                                                },
                                                "RelatedIPAlertsFound": {
                                                    "type": "boolean",
                                                    "description": "true if any Related Alerts found for IP Entities"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/watchlist')]": {
                            "post": {
                                "summary": "Watchlist Module",
                                "description": "Sentinel Triage AssistanT Module for determining if incident entities are on a Sentinel watchlist.",
                                "operationId": "WatchlistModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "WatchlistKey": {
                                                    "type": "string",
                                                    "description": "Enter the column name from the watchlist to match to the entity data"
                                                },
                                                "WatchlistKeyDataType": {
                                                    "type": "string",
                                                    "description": "Enter the format of the data in the WatchlistKey column.  UPN, IP or CIDR.",
                                                    "enum": [
                                                        "UPN",
                                                        "IP",
                                                        "CIDR",
                                                        "FQDN"
                                                    ]
                                                },
                                                "WatchlistName": {
                                                    "type": "string",
                                                    "description": "Alias of the Microsoft Sentinel watchlist",
                                                    "title": "WatchlistAlias"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "WatchlistKey",
                                                "WatchlistKeyDataType",
                                                "WatchlistName"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "OnWatchlist": {
                                                                "type": "boolean",
                                                                "description": "true if Entity on watchlist in DetailedResults array"
                                                            },
                                                            "EntityData": {
                                                                "type": "string",
                                                                "description": "Entity in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                },
                                                "EntitiesAnalyzedCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Entities Analyzed against watchlist"
                                                },
                                                "EntitiesOnWatchlist": {
                                                    "type": "boolean",
                                                    "description": "true if any Entities are on the Watchlist"
                                                },
                                                "EntitiesOnWatchlistCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Entities on Watchlist"
                                                },
                                                "WatchlistName": {
                                                    "type": "string",
                                                    "description": "Name of the watchlist evaluated"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/kql')]": {
                            "post": {
                                "summary": "Kusto Query Language (KQL) Module",
                                "description": "Sentinel Triage AssistanT Module for running custom KQL queries against Microsoft Sentinel or Microsoft 365 Security.",
                                "operationId": "KQLModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "KQLQuery": {
                                                    "type": "string",
                                                    "description": "Enter the KQL query you want to execute"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Enter the number of days you want to lookback in the KQL Data"
                                                },
                                                "QueryDescription": {
                                                    "type": "string",
                                                    "description": "This description will be added to the incident comment for additional context on the query",
                                                    "x-ms-visibility": "important"
                                                },
                                                "RunQueryAgainst": {
                                                    "type": "string",
                                                    "description": "Run the KQL Query against Microsoft Sentinel or Microsoft 365 Security",
                                                    "enum": [
                                                        "Sentinel",
                                                        "M365"
                                                    ]
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "KQLQuery",
                                                "LookbackInDays",
                                                "RunQueryAgainst"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "Array of DetailedResults"
                                                },
                                                "ResultsCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of results"
                                                },
                                                "ResultsFound": {
                                                    "type": "boolean",
                                                    "description": "true if any results are found"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/ueba')]": {
                            "post": {
                                "summary": "User Entity Behavior Analytics Module",
                                "description": "Sentinel Triage AssistanT Module for determining if user entities have corresponding investigation priorities in Sentinel UEBA.",
                                "operationId": "UEBAModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Duration in days to lookback for UEBA Investigation Priorities"
                                                },
                                                "MinimumInvestigationPriority": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "enum":[1,2,3,4,5,6,7,8,9,10],
                                                    "description": "Minimum investigtaion priority to evaluate"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "LookbackInDays",
                                                "MinimumInvestigationPriority"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AllEntityEventCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Total count of all matching Investigation Priorities"
                                                },
                                                "AllEntityInvestigationPriorityAverage": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Average priority of all matching Investigation Priorities"
                                                },
                                                "AllEntityInvestigationPriorityMax": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Maximum priority of all matching Investigation Priorities"
                                                },
                                                "AllEntityInvestigationPrioritySum": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Sum of priority of all matching Investigation Priorities"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "InvestigationPrioritySum": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "Sum of Investigation Priority by user in DetailedResults array"
                                                            },
                                                            "InvestigationPriorityAverage": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "Average Investigation Priority by user in DetailedResults array"
                                                            },
                                                            "InvestigationPriorityMax": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "Max Investigation Priority by user in DetailedResults array"
                                                            },
                                                            "EventCount": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "Count of Investigation Priorities by user in DetailedResults array"
                                                            },
                                                            "UserPrincipalName": {
                                                                "type": "string",
                                                                "description": "UserPrincipalName in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                },
                                                "InvestigationPrioritiesFound": {
                                                    "type": "boolean",
                                                    "description": "true if any matching Investigation Priorities are found"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/aadrisks')]": {
                            "post": {
                                "summary": "AAD Risks Module",
                                "description": "Sentinel Triage AssistanT Module for determining if user entities have related Azure Active Directory risk data.",
                                "operationId": "AADRisksModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Duration in days to lookback for AAD Risk data"
                                                },
                                                "MFAFailureLookup": {
                                                    "type": "boolean",
                                                    "description": "Look for failed MFA attempts",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "title": "",
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "MFAFraudLookup": {
                                                    "type": "boolean",
                                                    "description": "Look for MFA Fraud reports",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "title": "",
                                                    "x-ms-visibility": "advanced"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "LookbackInDays"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AnalyzedEntities": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Count of Entities analyzed"
                                                },
                                                "FailedMFATotalCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Sum of all matching failed MFA attempts"
                                                },
                                                "HighestRiskLevel": {
                                                    "type": "string",
                                                    "description": "Highest risk level found for all the entities"
                                                },
                                                "MFAFraudTotalCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Sum of all matching fraudulant MFA attempts"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "UserFailedMFACount": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "UserFailedMFACount by user in DetailedResults array"
                                                            },
                                                            "UserMFAFraudCount": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "UserMFAFraudCount by user in DetailedResults array"
                                                            },
                                                            "UserId": {
                                                                "type": "string",
                                                                "description": "UserId in DetailedResults array"
                                                            },
                                                            "UserPrincipalName": {
                                                                "type": "string",
                                                                "description": "UserPrincipalName in DetailedResults array"
                                                            },
                                                            "UserRiskLevel": {
                                                                "type": "string",
                                                                "description": "UserRiskLevel by user in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/file')]": {
                            "post": {
                                "summary": "File Insights Module",
                                "description": "Sentinel Triage AssistanT Module for gaining insights into File entities.",
                                "operationId": "FileModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AnalyzedEntities": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "AnalyzedEntities"
                                                },
                                                "EntitiesAttachmentCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "EntitiesAttachmentCount"
                                                },
                                                "HashedInvalidSignatureCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "HashedInvalidSignatureCount"
                                                },
                                                "HashesLinkedToThreatCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "HashesLinkedToThreatCount"
                                                },
                                                "HashesNotMicrosoftSignedCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "HashesNotMicrosoftSignedCount"
                                                },
                                                "HashesThreatList": {
                                                    "type": "array",
                                                    "items": {},
                                                    "description": "HashesThreatList"
                                                },
                                                "MaximumGlobalPrevalence": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "MaximumGlobalPrevalence"
                                                },
                                                "MinimumGlobalPrevalence": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "MinimumGlobalPrevalence"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "EmailAttachmentCount": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "EmailAttachmentCount in DetailedResults array"
                                                            },
                                                            "EmailAttachmentFileSize": {
                                                                "type": "string",
                                                                "description": "EmailAttachmentFileSize in DetailedResults array"
                                                            },
                                                            "EmailAttachmentFirstSeen": {
                                                                "type": "string",
                                                                "description": "EmailAttachmentFirstSeen in DetailedResults array"
                                                            },
                                                            "EmailAttachmentLastSeen": {
                                                                "type": "string",
                                                                "description": "EmailAttachmentLastSeen in DetailedResults array"
                                                            },
                                                            "FileName": {
                                                                "type": "string",
                                                                "description": "FileName in DetailedResults array"
                                                            },
                                                            "GlobalFirstSeen": {
                                                                "type": "string",
                                                                "description": "GlobalFirstSeen in DetailedResults array"
                                                            },
                                                            "GlobalLastSeen": {
                                                                "type": "string",
                                                                "description": "GlobalLastSeen in DetailedResults array"
                                                            },
                                                            "GlobalPrevalence": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "GlobalPrevalence in DetailedResults array"
                                                            },
                                                            "IsCertificateValid": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "IsCertificateValid in DetailedResults array"
                                                            },
                                                            "MD5": {
                                                                "type": "string",
                                                                "description": "MD5 in DetailedResults array"
                                                            },
                                                            "Publisher": {
                                                                "type": "string",
                                                                "description": "Publisher in DetailedResults array"
                                                            },
                                                            "SHA1": {
                                                                "type": "string",
                                                                "description": "SHA1 in DetailedResults array"
                                                            },
                                                            "SHA256": {
                                                                "type": "string",
                                                                "description": "SHA256 in DetailedResults array"
                                                            },
                                                            "SignatureState": {
                                                                "type": "string",
                                                                "description": "SignatureState in DetailedResults array"
                                                            },
                                                            "ThreatName": {
                                                                "type": "string",
                                                                "description": "ThreatName in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/mde')]": {
                            "post": {
                                "summary": "Microsoft Defender for Endpoint Module",
                                "description": "Sentinel Triage AssistanT Module for getting MDE insights into device entities.",
                                "operationId": "MDEModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "LookbackInDays": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "minimum": 1,
                                                    "maximum": 30,
                                                    "description": "Enter the number of days you want to lookback in MDE data"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "LookbackInDays"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AnalyzedEntities": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "AnalyzedEntities"
                                                },
                                                "IPsHighestExposureLevel": {
                                                    "type": "string",
                                                    "description": "IPsHighestExposureLevel"
                                                },
                                                "IPsHighestRiskScore": {
                                                    "type": "string",
                                                    "description": "IPsHighestRiskScore"
                                                },
                                                "UsersHighestExposureLevel": {
                                                    "type": "string",
                                                    "description": "UsersHighestExposureLevel"
                                                },
                                                "UsersHighestRiskScore": {
                                                    "type": "string",
                                                    "description": "UsersHighestRiskScore"
                                                },
                                                "HostsHighestExposureLevel": {
                                                    "type": "string",
                                                    "description": "HostsHighestExposureLevel"
                                                },
                                                "HostsHighestRiskScore": {
                                                    "type": "string",
                                                    "description": "HostsHighestRiskScore"
                                                },
                                                "DetailedResults": {
                                                    "type": "object",
                                                    "properties": {
                                                        "Accounts": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "UserDevices": {
                                                                        "type": "array",
                                                                        "items": {
                                                                            "type": "object",
                                                                            "properties": {
                                                                                "id": {
                                                                                    "type": "string",
                                                                                    "description": "id"
                                                                                },
                                                                                "computerDnsName": {
                                                                                    "type": "string",
                                                                                    "description": "computerDnsName"
                                                                                },
                                                                                "riskScore": {
                                                                                    "type": "string",
                                                                                    "description": "riskScore"
                                                                                },
                                                                                "exposureLevel": {
                                                                                    "type": "string",
                                                                                    "description": "exposureLevel"
                                                                                }
                                                                            }
                                                                        },
                                                                        "description": "UserDevices"
                                                                    },
                                                                    "UserHighestExposureLevel": {
                                                                        "type": "string",
                                                                        "description": "UserHighestExposureLevel"
                                                                    },
                                                                    "UserHighestRiskScore": {
                                                                        "type": "string",
                                                                        "description": "UserHighestRiskScore"
                                                                    },
                                                                    "UserId": {
                                                                        "type": "string",
                                                                        "description": "UserId"
                                                                    },
                                                                    "UserPrincipalName": {
                                                                        "type": "string",
                                                                        "description": "UserPrincipalName"
                                                                    },
                                                                    "UserSid": {
                                                                        "type": "string",
                                                                        "description": "UserSid"
                                                                    }
                                                                }
                                                            },
                                                            "description": "Accounts"
                                                        },
                                                        "IPs": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "Address": {
                                                                        "type": "string",
                                                                        "description": "Address"
                                                                    },
                                                                    "IPDevices": {
                                                                        "type": "array",
                                                                        "items": {},
                                                                        "description": "IPDevices"
                                                                    },
                                                                    "IPHighestExposureLevel": {
                                                                        "type": "string",
                                                                        "description": "IPHighestExposureLevel"
                                                                    },
                                                                    "IPHighestRiskScore": {
                                                                        "type": "string",
                                                                        "description": "IPHighestRiskScore"
                                                                    }
                                                                }
                                                            },
                                                            "description": "IPs"
                                                        },
                                                        "Hosts": {
                                                            "type": "array",
                                                            "items": {
                                                                "type": "object",
                                                                "properties": {
                                                                    "id": {
                                                                        "type": "string",
                                                                        "description": "id"
                                                                    },
                                                                    "computerDnsName": {
                                                                        "type": "string",
                                                                        "description": "computerDnsName"
                                                                    },
                                                                    "riskScore": {
                                                                        "type": "string",
                                                                        "description": "riskScore"
                                                                    },
                                                                    "exposureLevel": {
                                                                        "type": "string",
                                                                        "description": "exposureLevel"
                                                                    }
                                                                }
                                                            },
                                                            "description": "Hosts"
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/mcas')]": {
                            "post": {
                                "summary": "Microsoft Defender for Cloud Apps Module",
                                "description": "Sentinel Triage AssistanT Module for determining if user entities have investigation priorities in Microsoft Defender for Cloud Apps.",
                                "operationId": "MCASModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "ScoreThreshold": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Type the minimum investigation score",
                                                    "minimum": 1,
                                                    "maximum": 100
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "ScoreThreshold"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AboveThreholdCount": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "AboveThreholdCount"
                                                },
                                                "AnalyzedEntities": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "AnalyzedEntities"
                                                },
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "ThreatScore": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "ThreatScore in DetailedResults array"
                                                            },
                                                            "UserId": {
                                                                "type": "string",
                                                                "description": "UserId in DetailedResults array"
                                                            },
                                                            "UserPrincipalName": {
                                                                "type": "string",
                                                                "description": "UserPrincipalName in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "Array of DetailedResults"
                                                },
                                                "MaximumScore": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "MaximumScore"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/scoring')]": {
                            "post": {
                                "summary": "Risk Scoring Module",
                                "description": "Sentinel Triage AssistanT Module for determining the risk score of your incident based on the inputs of other STAT modules.",
                                "operationId": "ScoringModule",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "ScoringData": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "ModuleBody": {
                                                                "type": "object",
                                                                "description": "Body of Module to Score"
                                                            },
                                                            "ScoreLabel": {
                                                                "type": "string",
                                                                "description": "Friendly Name for Scored Data"
                                                            },
                                                            "ScoreMultiplier": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "description": "Score Multiplier"
                                                            },
                                                            "ScorePerItem": {
                                                                "type": "boolean",
                                                                "description": "Score Per Item"
                                                            }
                                                        }
                                                    }
                                                }
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "ScoringData"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "DetailedResults": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "properties": {
                                                            "Score": {
                                                                "type": "integer",
                                                                "format": "int32",
                                                                "description": "Item level score in DetailedResults array"
                                                            },
                                                            "ScoreSource": {
                                                                "type": "string",
                                                                "description": "Item level score source in DetailedResults array"
                                                            }
                                                        }
                                                    },
                                                    "description": "An array of individual scored items that make up the Total score"
                                                },
                                                "TotalScore": {
                                                    "type": "integer",
                                                    "format": "int32",
                                                    "description": "Total score (Sum of all scored items)"
                                                }
                                            }
                                        }
                                    }
                                }
                            }
                        },
                        "[concat(string(split(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[1],'?')[0]), '/func/runplaybook')]": {
                            "post": {
                                "summary": "Run Playbook Module",
                                "description": "Sentinel Triage AssistanT Module for running Microsoft Sentinel Playbooks.",
                                "operationId": "RunPlaybook",
                                "parameters": [
                                    {
                                        "name": "api-version",
                                        "default": "2016-10-01",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sp",
                                        "default": "/triggers/manual/run",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sv",
                                        "default": "1.0",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "sig",
                                        "default": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, 'sig=')[1])]",
                                        "in": "query",
                                        "type": "string",
                                        "required": true,
                                        "x-ms-visibility": "internal"
                                    },
                                    {
                                        "name": "body",
                                        "in": "body",
                                        "schema": {
                                            "type": "object",
                                            "properties": {
                                                "AddIncidentComments": {
                                                    "type": "boolean",
                                                    "description": "Add Comments to Microsoft Sentinel Incident",
                                                    "title": "",
                                                    "enum": [
                                                        true,
                                                        false
                                                    ],
                                                    "x-ms-visibility": "advanced"
                                                },
                                                "BaseModuleBody": {
                                                    "type": "string",
                                                    "description": "Body from STAT Base Module",
                                                    "title": "",
                                                    "x-ms-visibility": "important"
                                                },
                                                "LogicAppResourceId": {
                                                    "type": "string",
                                                    "description": "Resource Id of the Playbook you want to run"
                                                },
                                                "TenantId": {
                                                    "type": "string",
                                                    "description": "Azure AD Tenant Id"
                                                },
                                                "PlaybookName": {
                                                    "type": "string",
                                                    "description": "This description will be added to the incident comment for additional context on which Playbook was executed",
                                                    "x-ms-visibility": "important"
                                                }
                                            },
                                            "default": {
                                                "AddIncidentComments": true,
                                                "Entities": ""
                                            },
                                            "required": [
                                                "BaseModuleBody",
                                                "LogicAppResourceId",
                                                "TenantId",
                                                "PlaybookName"
                                            ]
                                        },
                                        "required": true
                                    }
                                ],
                                "responses": {
                                    "default": {
                                        "description": "default",
                                        "schema": {
                                            "type": "object",
                                            "properties": {}
                                        }
                                    }
                                }
                            }
                        }
                    },
                    "definitions": {},
                    "parameters": {},
                    "responses": {},
                    "securityDefinitions": {},
                    "security": [],
                    "tags": []
                },
                "apiType": "Rest",
                "backendService": {
                    "serviceUrl": "[string(split(listCallbackUrl(resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual'), '2017-07-01').value, ':443')[0])]"
                }
            }
        },
        {
            "type": "Microsoft.Logic/workflows",
            "apiVersion": "2017-07-01",
            "name": "[parameters('STATCoordinatorPlaybookName')]",
            "location": "[resourceGroup().location]",
            "properties": {
                "state": "Enabled",
                "definition": {
                    "$schema": "https://schema.management.azure.com/providers/Microsoft.Logic/schemas/2016-06-01/workflowdefinition.json#",
                    "contentVersion": "1.0.0.0",
                    "parameters": {
                        "PlaybookVersion": {
                            "defaultValue": "0.5.0",
                            "type": "String"
                        },
                        "PlaybookInternalName": {
                            "defaultValue": "CoordinatorModule",
                            "type": "String"
                        },
                        "ProjectName": {
                            "defaultValue": "STAT",
                            "type": "String"
                        }
                    },
                    "triggers": {
                        "manual": {
                            "type": "Request",
                            "kind": "Http",
                            "inputs": {
                                "method": "POST",
                                "relativePath": "/func/{funcname}",
                                "schema": {
                                    "properties": {
                                        "AddIncidentComments": {
                                            "type": "boolean"
                                        },
                                        "BaseModuleBody": {
                                            "description": "Body of Base Module",
                                            "type": "string"
                                        },
                                        "EnrichIPsWithGeoData": {
                                            "type": "boolean"
                                        },
                                        "Entities": {
                                            "description": "Click here and select the Entities object from the Dynamic content menu",
                                            "type": "string"
                                        },
                                        "IncidentARMId": {
                                            "description": "Click here and select the Incident ARM ID object from the Dynamic content menu",
                                            "type": "string"
                                        },
                                        "WorkspaceId": {
                                            "description": "Click here and select the Workspace ID object from the Dynamic content menu",
                                            "type": "string"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "actions": {
                        "Switch": {
                            "runAfter": {},
                            "cases": {
                                "Case_-_AADRisks": {
                                    "case": "aadrisks",
                                    "actions": {
                                        "Get-AADUserRisksInfo": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']",
                                                    "MFAFailureLookup": "@coalesce(triggerBody()?['MFAFailureLookup'], true)",
                                                    "MFAFraudLookup": "@coalesce(triggerBody()?['MFAFraudLookup'], true)"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('AADRisks_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_AADUserRisks": {
                                            "runAfter": {
                                                "Get-AADUserRisksInfo": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-AADUserRisksInfo')",
                                                "statusCode": "@outputs('Get-AADUserRisksInfo')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_Base_Module": {
                                    "case": "base",
                                    "actions": {
                                        "Base-Module": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddAccountComment": "@coalesce(triggerBody()?['AddAccountComments'], true)",
                                                    "AddIPComment": "@coalesce(triggerBody()?['AddIPComments'], true)",
                                                    "EnrichIPsWithGeoData": "@coalesce(triggerBody()?['EnrichIPsWithGeoData'], true)",
                                                    "Entities": "@triggerBody()?['Entities']",
                                                    "IncidentARMId": "@triggerBody()?['IncidentARMId']",
                                                    "WorkspaceId": "@triggerBody()?['WorkspaceId']"
                                                },
                                                "host": {
                                                    "triggerName": "enrich",
                                                    "workflow": {
                                                        "id": "[parameters('BaseModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_Base": {
                                            "runAfter": {
                                                "Base-Module": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Base-Module')",
                                                "statusCode": "@outputs('Base-Module')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_File": {
                                    "case": "file",
                                    "actions": {
                                        "Get-FileInsights": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('FileModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_File": {
                                            "runAfter": {
                                                "Get-FileInsights": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-FileInsights')",
                                                "statusCode": "@outputs('Get-FileInsights')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_KQL": {
                                    "case": "kql",
                                    "actions": {
                                        "Response_-_KQL": {
                                            "runAfter": {
                                                "Run-KQLQuery": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Run-KQLQuery')",
                                                "statusCode": "@outputs('Run-KQLQuery')['statusCode']"
                                            }
                                        },
                                        "Run-KQLQuery": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "KQLQuery": "@triggerBody()?['KQLQuery']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']",
                                                    "QueryDescription": "@{triggerBody()?['QueryDescription']}",
                                                    "RunQueryAgainst": "@triggerBody()?['RunQueryAgainst']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('KQLModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        }
                                    }
                                },
                                "Case_-_MCAS": {
                                    "case": "mcas",
                                    "actions": {
                                        "Get-MCASInvestigationScore": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "ScoreThreshold": "@triggerBody()?['ScoreThreshold']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('MCASModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_MCAS": {
                                            "runAfter": {
                                                "Get-MCASInvestigationScore": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-MCASInvestigationScore')",
                                                "statusCode": "@outputs('Get-MCASInvestigationScore')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_MDE": {
                                    "case": "mde",
                                    "actions": {
                                        "Get-MDEUsersDevicesRiskScore": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('MDEModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_MDE": {
                                            "runAfter": {
                                                "Get-MDEUsersDevicesRiskScore": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-MDEUsersDevicesRiskScore')",
                                                "statusCode": "@outputs('Get-MDEUsersDevicesRiskScore')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_OOF_Module": {
                                    "case": "oofmodule",
                                    "actions": {
                                        "Get-OOFDetails": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('OOFModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_OOF": {
                                            "runAfter": {
                                                "Get-OOFDetails": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-OOFDetails')",
                                                "statusCode": "@outputs('Get-OOFDetails')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_Related_Alerts": {
                                    "case": "relatedalerts",
                                    "actions": {
                                        "Get-RelatedAlerts": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "CheckAccountEntityMatches": "@coalesce(triggerBody()?['CheckAccounts'], true)",
                                                    "CheckHostEntityMatches": "@coalesce(triggerBody()?['CheckHosts'], true)",
                                                    "CheckIPEntityMatches": "@coalesce(triggerBody()?['CheckIPs'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('RelatedAlertsModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_RelatedAlerts": {
                                            "runAfter": {
                                                "Get-RelatedAlerts": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-RelatedAlerts')",
                                                "statusCode": "@outputs('Get-RelatedAlerts')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_Run_Playbook": {
                                    "case": "runplaybook",
                                    "actions": {
                                        "Response_-_Run-Playbook": {
                                            "runAfter": {
                                                "Run-Playbook": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Run-Playbook')",
                                                "statusCode": "@outputs('Run-Playbook')['statusCode']"
                                            }
                                        },
                                        "Run-Playbook": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LogicAppResourceId": "@{triggerBody()?['LogicAppResourceId']}",
                                                    "PlaybookName": "@{triggerBody()?['PlaybookName']}",
                                                    "TenantId": "@{triggerBody()?['TenantId']}"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('RunPlaybook_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        }
                                    }
                                },
                                "Case_-_Scoring": {
                                    "case": "scoring",
                                    "actions": {
                                        "Calculate-RiskScore": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "BaseModuleBody": "@triggerBody()?['BaseModuleBody']",
                                                    "ScoringData": "@triggerBody()?['ScoringData']"
                                                },
                                                "host": {
                                                    "triggerName": "calculatescore",
                                                    "workflow": {
                                                        "id": "[parameters('ScoringModule_resourceid')]"
                                                    }
                                                }
                                            }
                                        },
                                        "Response_-_Calculate-RiskScore": {
                                            "runAfter": {
                                                "Calculate-RiskScore": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Calculate-RiskScore')",
                                                "statusCode": "@outputs('Calculate-RiskScore')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_Threat_Intel": {
                                    "case": "threatintel",
                                    "actions": {
                                        "Get-ThreatIntel": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "CheckDomains": "@coalesce(triggerBody()?['CheckDomains'], true)",
                                                    "CheckFileHashes": "@coalesce(triggerBody()?['CheckFileHashes'], true)",
                                                    "CheckIPs": "@coalesce(triggerBody()?['CheckIPs'], true)",
                                                    "CheckURLs": "@coalesce(triggerBody()?['CheckURLs'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('ThreatIntelModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_ThreatIntel": {
                                            "runAfter": {
                                                "Get-ThreatIntel": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-ThreatIntel')",
                                                "statusCode": "@outputs('Get-ThreatIntel')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_UEBA": {
                                    "case": "ueba",
                                    "actions": {
                                        "Get-UEBAInsights": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "LookbackInDays": "@triggerBody()?['LookbackInDays']",
                                                    "MinimumInvestigationPriority": "@triggerBody()?['MinimumInvestigationPriority']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('UEBAModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_UEBA": {
                                            "runAfter": {
                                                "Get-UEBAInsights": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-UEBAInsights')",
                                                "statusCode": "@outputs('Get-UEBAInsights')['statusCode']"
                                            }
                                        }
                                    }
                                },
                                "Case_-_Watchlist": {
                                    "case": "watchlist",
                                    "actions": {
                                        "Get-WatchlistInsights": {
                                            "runAfter": {},
                                            "type": "Workflow",
                                            "inputs": {
                                                "body": {
                                                    "AddIncidentComments": "@coalesce(triggerBody()?['AddIncidentComments'], true)",
                                                    "Entities": "@triggerBody()?['BaseModuleBody']",
                                                    "WatchlistKey": "@triggerBody()?['WatchlistKey']",
                                                    "WatchlistKeyDataType": "@triggerBody()?['WatchlistKeyDataType']",
                                                    "WatchlistName": "@triggerBody()?['WatchlistName']"
                                                },
                                                "host": {
                                                    "triggerName": "triage",
                                                    "workflow": {
                                                        "id": "[parameters('WatchlistModule_resourceid')]"
                                                    }
                                                },
                                                "retryPolicy": {
                                                    "type": "none"
                                                }
                                            }
                                        },
                                        "Response_-_Watchlist": {
                                            "runAfter": {
                                                "Get-WatchlistInsights": [
                                                    "Succeeded",
                                                    "TimedOut",
                                                    "Failed"
                                                ]
                                            },
                                            "type": "Response",
                                            "kind": "Http",
                                            "inputs": {
                                                "body": "@body('Get-WatchlistInsights')",
                                                "statusCode": "@outputs('Get-WatchlistInsights')['statusCode']"
                                            }
                                        }
                                    }
                                }
                            },
                            "default": {
                                "actions": {
                                    "Response_-_Invalid_Module": {
                                        "runAfter": {},
                                        "type": "Response",
                                        "kind": "Http",
                                        "inputs": {
                                            "body": {
                                                "Error": "STAT Module not found in the coordinator.  Either the module is invalid or the coordinator needs to be updated."
                                            },
                                            "statusCode": 500
                                        }
                                    }
                                }
                            },
                            "expression": "@triggerOutputs()['relativePathParameters']['funcname']",
                            "type": "Switch"
                        }
                    },
                    "outputs": {}
                },
                "parameters": {}
            }
        }
    ],
    "outputs": {
        "connectorResourceId": {
            "type": "string",
            "value": "[resourceId('Microsoft.Web/customApis', parameters('CustomConnectorName'))]"
        },
        "coordinatorTriggerResourceId": {
            "type": "string",
            "value": "[resourceId('Microsoft.Logic/workflows/triggers', parameters('STATCoordinatorPlaybookName'), 'manual')]"
        }
    }
}